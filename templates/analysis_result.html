<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>企业信用评估系统 - 分析结果</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .navbar {
            background: rgba(255, 255, 255, 0.95) !important;
            backdrop-filter: blur(10px);
            box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1);
        }
        .result-container {
            max-width: 1200px;
            margin: 30px auto;
            padding: 30px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
        }
        .section-card {
            background: #f8f9ff;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            border-left: 4px solid #667eea;
        }
        .metric-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 15px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            transition: transform 0.2s ease;
        }
        .metric-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        .metric-label {
            font-weight: 600;
            color: #495057;
            margin-bottom: 8px;
        }
        .metric-value {
            font-size: 1.2rem;
            font-weight: 700;
            color: #667eea;
        }
        .metric-value.null {
            color: #6c757d;
            font-style: italic;
        }
        .category-title {
            color: #667eea;
            font-weight: 700;
            margin-bottom: 20px;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }
        .btn-next {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            border-radius: 10px;
            padding: 12px 30px;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        .btn-next:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        .company-info {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
        }
        .info-item {
            margin-bottom: 10px;
        }
        .info-label {
            font-weight: 600;
            margin-right: 10px;
        }
        .progress-section {
            margin: 30px 0;
        }
        .step-indicator {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
        }
        .step {
            display: flex;
            align-items: center;
            margin: 0 15px;
        }
        .step-number {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #e9ecef;
            color: #6c757d;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            margin-right: 10px;
        }
        .step-number.active {
            background: #667eea;
            color: white;
        }
        .step-number.completed {
            background: #28a745;
            color: white;
        }
        .step-text {
            font-weight: 600;
            color: #495057;
        }
        .step-text.active {
            color: #667eea;
        }
        .step-text.completed {
            color: #28a745;
        }
    </style>
</head>
<body>
    <!-- 导航栏 -->
    <nav class="navbar navbar-expand-lg navbar-light">
        <div class="container">
            <a class="navbar-brand" href="#">
                <i class="fas fa-chart-line me-2"></i>企业信用评估系统
            </a>
            <div class="navbar-nav ms-auto">
                <span class="navbar-text me-3">
                    <i class="fas fa-user me-1"></i>欢迎，{{ session.get('username', '用户') }}
                </span>
                <a class="nav-link" href="{{ url_for('logout') }}">
                    <i class="fas fa-sign-out-alt me-1"></i>登出
                </a>
            </div>
        </div>
    </nav>

    <div class="container">
        <div class="result-container">
            <!-- 进度指示器 -->
            <div class="progress-section">
                <div class="step-indicator">
                    <div class="step">
                        <div class="step-number completed">
                            <i class="fas fa-check"></i>
                        </div>
                        <div class="step-text completed">PDF上传</div>
                    </div>
                    <div class="step">
                        <div class="step-number active">2</div>
                        <div class="step-text active">数据分析</div>
                    </div>
                    <div class="step">
                        <div class="step-number">3</div>
                        <div class="step-text">信用评估</div>
                    </div>
                    <div class="step">
                        <div class="step-number">4</div>
                        <div class="step-text">最终报告</div>
                    </div>
                </div>
            </div>

            <!-- 公司基本信息 -->
            {% if analysis_data.extracted_data %}
            <div class="company-info">
                <h3><i class="fas fa-building me-2"></i>公司基本信息</h3>
                <div class="row">
                    <div class="col-md-6">
                        <div class="info-item">
                            <span class="info-label">公司名称:</span>
                            <span>{{ analysis_data.extracted_data.Name or 'N/A' }}</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">股票代码:</span>
                            <span>{{ analysis_data.extracted_data.Symbol or 'N/A' }}</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">所属行业:</span>
                            <span>{{ analysis_data.extracted_data.Sector or 'N/A' }}</span>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="info-item">
                            <span class="info-label">信用评级:</span>
                            <span>{{ analysis_data.extracted_data.Rating or 'N/A' }}</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">评级机构:</span>
                            <span>{{ analysis_data.extracted_data['Rating Agency Name'] or 'N/A' }}</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">评级日期:</span>
                            <span>{{ analysis_data.extracted_data.Date or 'N/A' }}</span>
                        </div>
                    </div>
                </div>
            </div>
            {% endif %}

            <!-- 财务指标分析 -->
            {% if analysis_data.extracted_data %}
            <div class="section-card">
                <h4 class="category-title">
                    <i class="fas fa-chart-bar me-2"></i>财务指标分析
                </h4>
                
                <!-- 流动性指标 -->
                <div class="row mb-4">
                    <div class="col-12">
                        <h5 class="text-primary mb-3">
                            <i class="fas fa-tint me-2"></i>流动性指标
                        </h5>
                    </div>
                    <div class="col-md-3">
                        <div class="metric-card">
                            <div class="metric-label">流动比率</div>
                            <div class="metric-value {% if not analysis_data.extracted_data.currentRatio or analysis_data.extracted_data.currentRatio == 'N/A' %}null{% endif %}">
                                {{ analysis_data.extracted_data.currentRatio or 'N/A' }}
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="metric-card">
                            <div class="metric-label">速动比率</div>
                            <div class="metric-value {% if not analysis_data.extracted_data.quickRatio or analysis_data.extracted_data.quickRatio == 'N/A' %}null{% endif %}">
                                {{ analysis_data.extracted_data.quickRatio or 'N/A' }}
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="metric-card">
                            <div class="metric-label">现金比率</div>
                            <div class="metric-value {% if not analysis_data.extracted_data.cashRatio or analysis_data.extracted_data.cashRatio == 'N/A' %}null{% endif %}">
                                {{ analysis_data.extracted_data.cashRatio or 'N/A' }}
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="metric-card">
                            <div class="metric-label">应收账款周转天数</div>
                            <div class="metric-value {% if not analysis_data.extracted_data.daysOfSalesOutstanding or analysis_data.extracted_data.daysOfSalesOutstanding == 'N/A' %}null{% endif %}">
                                {{ analysis_data.extracted_data.daysOfSalesOutstanding or 'N/A' }}
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 盈利能力指标 -->
                <div class="row mb-4">
                    <div class="col-12">
                        <h5 class="text-success mb-3">
                            <i class="fas fa-chart-line me-2"></i>盈利能力指标
                        </h5>
                    </div>
                    <div class="col-md-3">
                        <div class="metric-card">
                            <div class="metric-label">净利润率</div>
                            <div class="metric-value {% if not analysis_data.extracted_data.netProfitMargin or analysis_data.extracted_data.netProfitMargin == 'N/A' %}null{% endif %}">
                                {{ analysis_data.extracted_data.netProfitMargin or 'N/A' }}
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="metric-card">
                            <div class="metric-label">税前利润率</div>
                            <div class="metric-value {% if not analysis_data.extracted_data.pretaxProfitMargin or analysis_data.extracted_data.pretaxProfitMargin == 'N/A' %}null{% endif %}">
                                {{ analysis_data.extracted_data.pretaxProfitMargin or 'N/A' }}
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="metric-card">
                            <div class="metric-label">毛利率</div>
                            <div class="metric-value {% if not analysis_data.extracted_data.grossProfitMargin or analysis_data.extracted_data.grossProfitMargin == 'N/A' %}null{% endif %}">
                                {{ analysis_data.extracted_data.grossProfitMargin or 'N/A' }}
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="metric-card">
                            <div class="metric-label">营业利润率</div>
                            <div class="metric-value {% if not analysis_data.extracted_data.operatingProfitMargin or analysis_data.extracted_data.operatingProfitMargin == 'N/A' %}null{% endif %}">
                                {{ analysis_data.extracted_data.operatingProfitMargin or 'N/A' }}
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 回报率指标 -->
                <div class="row mb-4">
                    <div class="col-12">
                        <h5 class="text-info mb-3">
                            <i class="fas fa-percentage me-2"></i>回报率指标
                        </h5>
                    </div>
                    <div class="col-md-4">
                        <div class="metric-card">
                            <div class="metric-label">资产回报率 (ROA)</div>
                            <div class="metric-value {% if not analysis_data.extracted_data.returnOnAssets or analysis_data.extracted_data.returnOnAssets == 'N/A' %}null{% endif %}">
                                {{ analysis_data.extracted_data.returnOnAssets or 'N/A' }}
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="metric-card">
                            <div class="metric-label">资本回报率 (ROCE)</div>
                            <div class="metric-value {% if not analysis_data.extracted_data.returnOnCapitalEmployed or analysis_data.extracted_data.returnOnCapitalEmployed == 'N/A' %}null{% endif %}">
                                {{ analysis_data.extracted_data.returnOnCapitalEmployed or 'N/A' }}
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="metric-card">
                            <div class="metric-label">净资产收益率 (ROE)</div>
                            <div class="metric-value {% if not analysis_data.extracted_data.returnOnEquity or analysis_data.extracted_data.returnOnEquity == 'N/A' %}null{% endif %}">
                                {{ analysis_data.extracted_data.returnOnEquity or 'N/A' }}
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 杠杆指标 -->
                <div class="row mb-4">
                    <div class="col-12">
                        <h5 class="text-warning mb-3">
                            <i class="fas fa-balance-scale me-2"></i>杠杆指标
                        </h5>
                    </div>
                    <div class="col-md-4">
                        <div class="metric-card">
                            <div class="metric-label">债务权益比</div>
                            <div class="metric-value {% if not analysis_data.extracted_data.debtEquityRatio or analysis_data.extracted_data.debtEquityRatio == 'N/A' %}null{% endif %}">
                                {{ analysis_data.extracted_data.debtEquityRatio or 'N/A' }}
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="metric-card">
                            <div class="metric-label">资产负债率</div>
                            <div class="metric-value {% if not analysis_data.extracted_data.debtRatio or analysis_data.extracted_data.debtRatio == 'N/A' %}null{% endif %}">
                                {{ analysis_data.extracted_data.debtRatio or 'N/A' }}
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="metric-card">
                            <div class="metric-label">权益乘数</div>
                            <div class="metric-value {% if not analysis_data.extracted_data.companyEquityMultiplier or analysis_data.extracted_data.companyEquityMultiplier == 'N/A' %}null{% endif %}">
                                {{ analysis_data.extracted_data.companyEquityMultiplier or 'N/A' }}
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 现金流指标 -->
                <div class="row">
                    <div class="col-12">
                        <h5 class="text-primary mb-3">
                            <i class="fas fa-money-bill-wave me-2"></i>现金流指标
                        </h5>
                    </div>
                    <div class="col-md-3">
                        <div class="metric-card">
                            <div class="metric-label">每股自由现金流</div>
                            <div class="metric-value {% if not analysis_data.extracted_data.freeCashFlowPerShare or analysis_data.extracted_data.freeCashFlowPerShare == 'N/A' %}null{% endif %}">
                                {{ analysis_data.extracted_data.freeCashFlowPerShare or 'N/A' }}
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="metric-card">
                            <div class="metric-label">每股现金</div>
                            <div class="metric-value {% if not analysis_data.extracted_data.cashPerShare or analysis_data.extracted_data.cashPerShare == 'N/A' %}null{% endif %}">
                                {{ analysis_data.extracted_data.cashPerShare or 'N/A' }}
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="metric-card">
                            <div class="metric-label">每股经营现金流</div>
                            <div class="metric-value {% if not analysis_data.extracted_data.operatingCashFlowPerShare or analysis_data.extracted_data.operatingCashFlowPerShare == 'N/A' %}null{% endif %}">
                                {{ analysis_data.extracted_data.operatingCashFlowPerShare or 'N/A' }}
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="metric-card">
                            <div class="metric-label">经营现金流/销售收入比率</div>
                            <div class="metric-value {% if not analysis_data.extracted_data.operatingCashFlowSalesRatio or analysis_data.extracted_data.operatingCashFlowSalesRatio == 'N/A' %}null{% endif %}">
                                {{ analysis_data.extracted_data.operatingCashFlowSalesRatio or 'N/A' }}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            {% endif %}

            <!-- 操作按钮 -->
            <div class="text-center mt-4">
                <a href="{{ url_for('credit_evaluation', session_id=session_id) }}" class="btn btn-primary btn-next">
                    <i class="fas fa-arrow-right me-2"></i>继续信用评估
                </a>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
